"0","pr_sofala<-raster::crop(prstack, sofala)%>%raster::mask(sofala)"
"0","temp_sofala<-raster::crop(tmp, sofala)%>%raster::mask(sofala)"
"0",""
"0","prdf_sofala<-as.data.frame(pr_sofala, xy=TRUE, na.rm=TRUE)%>% "
"0","  melt(id.vars=c('x','y'))"
"0","tmpdf_sofala<-as.data.frame(temp_sofala, xy=TRUE, na.rm=TRUE)%>%melt(id.vars=c('x', 'y'))"
"0",""
"0",""
"0","prdf_sofala$Date<-substr(prdf_sofala$variable, 2,11) "
"0","prdf_sofala$Year<-substr(prdf_sofala$Date,1,4)"
"0","prdf_sofala$Month<-substr(prdf_sofala$Date,6,7)"
"0",""
"0","colnames(prdf_sofala)[colnames(prdf_sofala)==""value""]<-""pr"""
"0",""
"0",""
"0","tmpdf_sofala$Date<-substr(tmpdf_sofala$variable, 2,11) "
"0","tmpdf_sofala$Year<-substr(tmpdf_sofala$Date,1,4)"
"0","tmpdf_sofala$Month<-substr(tmpdf_sofala$Date,6,7)"
"0",""
"0",""
"0","colnames(tmpdf_sofala)[colnames(tmpdf_sofala)==""value""]<-""tmean"""
"0",""
"0","pr_monthly<-prdf_sofala%>%dplyr::filter(Year>=1981)%>% group_by(Month)%>%"
"0","  summarise(across(contains(""pr""), ~mean(pr))) "
"0","pr_monthly$Month<-factor(pr_monthly$Month,levels = c('07','08','09','10','11','12','01','02','03','04','05','06')) #"
"0",""
"0",""
"0","temp_monthly<-tmpdf_sofala%>%dplyr::filter(Year>=1981)%>%group_by(Month)%>%summarise('tmean'=mean(tmean))"
"0","temp_monthly$Month<-factor(temp_monthly$Month, levels = c('07','08','09','10','11','12','01','02','03','04','05','06'))"
"0",""
"0","pr_tmp<-cbind(pr_monthly,temp_monthly)"
"0","pr_tmp<-pr_tmp[,-3]"
"0"," "
"0","ty<-list(overlaying = ""y"","
"0","  side = ""right"","
"0","  title = ""Temperature (Â°C)"","
"0","  autotick = FALSE,"
"0","      dtick = 10,"
"0"," range=c(0,30)"
"0","  )"
"0",""
"0","plotly::plot_ly(type= 'bar', data= pr_tmp, x= ~Month, y= ~pr, name = 'Precipitation')%>%"
"0","  plotly::add_lines(x= ~Month, y= ~tmean, mode = 'lines+markers',name= 'Temperature', yaxis='y2')%>%"
"0","  #plotly::add_markers(x= ~Month, y= ~tmean, pch=1,color='#D21919', yaxis='y2', name='')%>%"
"0","    plotly::layout(legend=list(orientation='h', y=-0.18,x=0.3), yaxis=list(title='Precipitation (mm)',showticklables=F, range=c(0,600)),width=600, height=500, title='Sofala \n (Mean 1981-2020)', yaxis2=ty)"
"2","Warning:"
"2"," Specifying width/height in layout() is now deprecated.
Please specify in ggplotly() or plot_ly()
"
